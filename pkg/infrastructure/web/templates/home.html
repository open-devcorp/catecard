{{ define "content" }}

<nav-component></nav-component>

<main class="max-w-7xl mx-auto px-4 xl:px-0 flex-1 w-full">
  <h2 class="text-2xl font-semibold">Hola, {{ .User.FullName }}</h2>
  <p class="mt-2 text-gray-600">Aquí está el resumen de tu catequesis</p>

  <!-- Sections -->
  <card-component class="mb-8"></card-component>
    <!-- Tabs -->
    <div id="tabs" class="mb-4 inline-flex rounded-2xl bg-[#E9E9ED] p-1">
      <button data-tab="group" class="px-3 py-1 rounded-xl text-sm cursor-pointer">Grupos</button>
      <button data-tab="user" class="px-3 py-1 rounded-xl text-sm cursor-pointer">Usuarios</button>
      <button data-tab="scan" class="px-3 py-1 rounded-xl text-sm cursor-pointer">Escaneos</button>
    </div>

  <div class="mt-4">
    <section data-zone="group" style="display:none">
      <group-component></group-component>
    </section>
    <section data-zone="user" style="display:none">
      <user-component></user-component>
    </section>
      <section data-zone="scan" style="display:block">
        <scan-component></scan-component>
      </section>
    </div>
</main>

<footer-component></footer-component>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const tabsContainer = document.getElementById('tabs');
      const buttons = () => Array.from(document.querySelectorAll('#tabs [data-tab]'));

      function setActive(key) {
        // re-query zones every time to avoid stale references if Vue re-renders
        const zones = Array.from(document.querySelectorAll('[data-zone]'));
        buttons().forEach(b => {
          b.classList.toggle('bg-white', b.dataset.tab === key);
          b.classList.toggle('text-[#1A388B]', b.dataset.tab === key);
        });
        zones.forEach(z => { if (z && z.dataset) z.style.display = (z.dataset.zone === key) ? 'block' : 'none'; });
        try { localStorage.setItem('home:activeTab', key); } catch(e){}
      }

      // delegate clicks from document so it still works even if Vue re-renders #tabs
      document.addEventListener('click', function (ev) {
        const target = ev.target || null;
        const b = (target && target.closest) ? target.closest('[data-tab]') : null;
        if (!b) return;
        const key = b.dataset.tab;
        setActive(key);
      });

      // Restaurar tab activo
      setActive(localStorage.getItem('home:activeTab') || 'scan');
    });
  </script>
</main>
{{ end }}